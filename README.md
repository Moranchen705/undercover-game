# 谁是卧底 - 多人语言推理游戏

一个基于Python开发的"谁是卧底"多人语言推理游戏平台，支持主持方和游戏方在局域网内进行实时游戏。

## 📋 项目简介

"谁是卧底"是一款多人语言推理类桌游，核心玩法是通过描述词语、观察他人发言来找出隐藏的"卧底"，同时保护己方阵营成员不被淘汰。

本项目分为两个部分：
- **主持方（1个组）**：负责构建游戏平台，提供可视化环境，管理游戏流程
- **游戏方（5个组）**：负责参与游戏，实现客户端和游戏策略

## 🎮 游戏规则

详细游戏规则请查看：[游戏说明.md](说明/游戏说明.md)

### 核心流程

1. 游戏方向主持方注册，获得组名
2. 主持方随机选择1个组作为卧底，其余作为平民
3. 向卧底发送"卧底词"，向平民发送"平民词"
4. 游戏方按顺序提交描述（间隔≤3秒）
5. 游戏方进行投票，选择怀疑的卧底
6. 主持方处理投票结果，判定淘汰和胜负
7. 重复步骤4-6，直到游戏结束

### 投票规则

- **情况a**：得票最多的组仅1个 → 该组被淘汰
- **情况b**：得票最多的组有3个，且均为平民 → 3组都淘汰，游戏结束
- **情况c**：得票最多的组有2个 → 进入下一轮

## 📁 项目结构

```
谁是卧底/
├── 平台方/                 # 主持方代码
│   ├── backend.py          # 后端服务器（Flask API）
│   ├── frontend.py         # 前端界面（Flask Web界面）
│   ├── game_logic.py       # 游戏逻辑核心模块
│   ├── test_client.py      # 测试客户端
│   ├── requirements.txt    # 依赖包
│   └── README.md           # 平台方说明
│
├── 玩家方/                 # 游戏方代码
│   ├── client.py           # 主程序入口（GUI界面）
│   ├── api_client.py       # API通信模块
│   ├── game_strategy.py    # 游戏策略模块
│   ├── Requirements.txt    # 依赖包
│   └── README.md           # 游戏方说明
│
├── 说明/                   # 项目文档
│   ├── 游戏说明.md         # 游戏规则说明
│   ├── 安装依赖指南.md     # 依赖安装说明
│   ├── 运行指南.md         # 运行使用指南
│   ├── 多机测试指南.md     # 多机联网测试指南
│   └── GitHub上传和使用指南.md  # GitHub协作指南
│
└── README.md               # 本文件
```

## 🚀 快速开始

### 1. 安装依赖

#### 平台方（主持方）
```bash
cd 平台方
pip install -r requirements.txt
```

#### 游戏方
```bash
cd 玩家方
pip install -r Requirements.txt
```

详细安装说明请查看：[安装依赖指南.md](说明/安装依赖指南.md)

### 2. 启动主持方服务器

```bash
cd 平台方
python backend.py
```

服务器启动后会显示：
- 本地访问：`http://127.0.0.1:5000`
- 局域网访问：`http://192.168.x.x:5000`（记录此IP，游戏方需要）

### 3. 启动主持方前端界面（可选）

```bash
cd 平台方
python frontend.py
```

访问：`http://127.0.0.1:5001`

### 4. 运行游戏方客户端

```bash
cd 玩家方
python client.py
```

在GUI界面中：
- 输入服务器地址（主持方的局域网IP）
- 输入组名
- 点击"注册"按钮

## 📖 详细文档

- [游戏说明.md](说明/游戏说明.md) - 完整的游戏规则和流程说明
- [安装依赖指南.md](说明/安装依赖指南.md) - 详细的依赖安装步骤
- [运行指南.md](说明/运行指南.md) - 运行使用和常见问题
- [多机测试指南.md](说明/多机测试指南.md) - 多台电脑联网测试指南
- [GitHub上传和使用指南.md](说明/GitHub上传和使用指南.md) - GitHub协作指南

## ✨ 功能特性

### 主持方功能
- ✅ 游戏方注册和组名管理
- ✅ 随机分配卧底和平民身份
- ✅ 接收和展示游戏方的描述（带时间戳）
- ✅ 实时显示投票进度和结果
- ✅ 处理投票并判定结果（符合规则a/b/c）
- ✅ 自动计算得分
- ✅ 异常上报与记录
- ✅ 可视化游戏管理界面

### 游戏方功能
- ✅ 组名注册
- ✅ 词语接收和展示
- ✅ 描述提交（含3秒时间限制）
- ✅ 投票提交
- ✅ 状态轮询（自动获取游戏阶段）
- ✅ 游戏策略实现
- ✅ 异常上报

## 🔧 技术栈

- **后端框架**：Flask
- **前端界面**：Flask + HTML/CSS/JavaScript
- **GUI框架**：Tkinter
- **网络通信**：HTTP RESTful API
- **并发处理**：threading

## 🌐 网络要求

- 所有电脑需在同一局域网内
- 局域网不能连外网
- 游戏方每组最多可使用3台计算机
- 主持方需要1台电脑运行服务器

## 👥 协作说明

### 主持方（1个组）
负责构建游戏平台，包括：
- 后端服务器开发
- 前端界面开发
- 游戏逻辑实现
- 多客户端并发处理

### 游戏方（5个组）
负责参与游戏，包括：
- 客户端程序开发
- 游戏策略实现
- 与主持方平台交互

## 📝 开发注意事项

1. **描述时间限制**：游戏方描述提交需在3秒内完成
2. **状态轮询**：建议每2-3秒轮询一次游戏状态
3. **网络稳定性**：确保局域网连接稳定
4. **错误处理**：所有API调用都需要处理错误情况

## 🐛 常见问题

### Q1: 连接失败怎么办？
- 确认主持方服务器已启动
- 检查服务器地址是否正确
- 确认网络连接正常
- 查看[运行指南.md](说明/运行指南.md)中的详细排查步骤

### Q2: 如何获取服务器IP地址？
- 后端服务器启动时会在控制台显示局域网IP
- 或查看启动日志中的"局域网访问"地址

### Q3: 可以同时运行多个客户端吗？
可以！每个客户端代表一个游戏组。详细方法请查看[运行指南.md](说明/运行指南.md)

## 📄 许可证

本项目为课程作业项目。

## 👨‍💻 贡献

本项目为多人协作项目，请参考[GitHub上传和使用指南.md](说明/GitHub上传和使用指南.md)了解如何参与协作。

---

**提示**：首次使用请先阅读[安装依赖指南.md](说明/安装依赖指南.md)和[运行指南.md](说明/运行指南.md)

